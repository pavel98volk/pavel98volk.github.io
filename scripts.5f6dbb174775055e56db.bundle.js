webpackJsonp([2,5],{3:function(t,r,e){t.exports=e("4msC")},"4msC":function(t,r,e){e("P+fo")(e("haKs"))},"P+fo":function(t,r){t.exports=function(t){"undefined"!=typeof execScript?execScript(t):eval.call(null,t)}},haKs:function(t,r){t.exports="var map;\r\nvar info_window;\r\nvar places_service;\r\nvar direction_service;\r\nvar selected_road;\r\nvar origin;\r\nvar origin_box;\r\nvar destination;\r\nvar destination_box;\r\nvar textarea;\r\n\r\nvar mouseover\t\t\t\t = false;\r\nvar live_road\t\t\t\t = true;\r\nvar last_town_destination\t = true;\r\nvar nearest_town_added\t\t = true;\r\n\r\nvar selected_places\t = {}; // key: place_id, value: {address, location}\r\nvar markers\t\t\t = {}; // key: place_id, value: googleMarker\r\n\r\nvar waypoints\t\t = []; // value: place_id\r\nvar roads\t\t\t = []; // value: {distance, legs, path}\r\nvar roads_display\t = []; // value: directionRenderer\r\nvar ordered_markers\t = []; // value: googleMarker\r\nvar colors = ['#4682B4','#00FF00','#FF0000','#FFFF00','#FF1493','#8B008B','#000000','#FF4500','#8B4513','#FF00FF'];\r\n\r\nfunction initMap(scene, origin_select, destination_select, info_output) {\r\n\tdeleteMap();\r\n\tvar position = {lat: 50.4501, lng: 30.523400000000038}; //Kiyv\r\n\tmap = new google.maps.Map(scene, {\r\n\t\tcenter: position,\r\n\t\tzoom: 8\r\n\t});\r\n\tif (origin_select !== undefined){\r\n\t\torigin_box = origin_select;\r\n\t}\r\n\tif (destination_select !== undefined){\r\n\t\tdestination_box = destination_select;\r\n\t}\r\n\tif (info_output !== undefined){\r\n\t\ttextarea = info_output;\r\n\t}\r\n\tmap.addListener('click', function(event){\r\n\t\tif (nearest_town_added === true){\r\n\t\t\tsearchNearestTown(event.latLng);\r\n\t\t} else {\r\n\t\t\tsearchTowns(event.latLng);\r\n\t\t}\r\n\t});\r\n\tplaces_service = new google.maps.places.PlacesService(map);\r\n\tdirection_service = new google.maps.DirectionsService;\r\n\tinfo_window = new google.maps.InfoWindow;\r\n}\r\n\r\nfunction searchNearestTown(position){\r\n\tplaces_service.search({\r\n\t\tlocation: position,\r\n\t\trankBy: google.maps.places.RankBy.DISTANCE,\r\n\t\ttypes: ['locality']\r\n\t}, searchCallback);\r\n}\r\n\r\nfunction searchTowns(position){\r\n\tplaces_service.radarSearch({\r\n\t\tlocation: position,\r\n\t\tradius: 10000,\r\n\t\ttypes: ['locality']\r\n\t}, radarCallback);\r\n}\r\n\r\nfunction searchCallback(results, status){\r\n\tif (status === google.maps.places.PlacesServiceStatus.OK){\r\n\t\tclearMarkers();\r\n\t\tclearOrderedMarkers();\r\n\t\tcreateMarker(results[0]);\r\n\t}\r\n}\r\n\r\nfunction radarCallback(results, status){\r\n\tif (status === google.maps.places.PlacesServiceStatus.OK){\r\n\t\tclearMarkers();\r\n\t\tclearOrderedMarkers();\r\n\t\tresults.forEach(function(result_item){\r\n\t\t\tcreateMarker(result_item);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction clearMarkers(){\r\n\tfor (place_id in markers){\r\n\t\tif (selected_places[place_id] === undefined){\r\n\t\t\tmarkers[place_id].setMap(null);\r\n\t\t\tdelete markers[place_id];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction createMarker(place){\r\n\tvar marker_place = {placeId: place.place_id, location: place.geometry.location};\r\n\tif (markers[place.place_id] !== undefined){\r\n\t\treturn;\r\n\t}\r\n\tvar marker = new google.maps.Marker({\r\n\t\tplace: marker_place,\r\n\t\tmap: map,\r\n\t\tzIndex: 1\r\n\t});\t\r\n\tmarker.addListener('click', function(){\r\n\t\tonMarkerClick(marker);\r\n\t});\r\n\tmarker.addListener('mouseover', function(){\r\n\t\tshowInfoWindow(marker);\t\r\n\t});\r\n\tmarker.addListener('mouseout', function(){\r\n\t\thideInfoWindow(marker);\r\n\t});\r\n\tif (nearest_town_added){\r\n\t\tonMarkerClick(marker);\r\n\t}\r\n\tmarkers[place.place_id] = marker;\r\n}\r\n\r\nfunction showInfoWindow(marker){\r\n\tmouseover = true;\r\n\tsetTimeout(function(){\r\n\t\tif (mouseover){\r\n\t\t\tplaces_service.getDetails({placeId: marker.getPlace().placeId}, function(result, status){\r\n\t\t\t\tif (status === google.maps.places.PlacesServiceStatus.OK){\r\n\t\t\t\t\tinfo_window.setContent(result.formatted_address);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tinfo_window.open(map, marker);\r\n\t\t}\r\n\t}, 600);\r\n\tmarker.setZIndex(2);\r\n}\r\n\r\nfunction hideInfoWindow(marker){\r\n\tmouseover = false;\r\n\tinfo_window.close();\t\r\n\tmarker.setZIndex(1);\r\n}\r\n\r\nfunction onMarkerClick(marker) {\r\n\tplaces_service.getDetails({placeId: marker.getPlace().placeId}, function(result, status){\r\n\t\tif (status === google.maps.places.PlacesServiceStatus.OK){\r\n\t\t\tif (selected_places[marker.getPlace().placeId] === undefined){\t\r\n\t\t\t\taddMarkerToRoad(marker, result);\t\t\t\r\n\t\t\t} else {\r\n\t\t\t\textractMarkerFromRoad(marker, result);\r\n\t\t\t}\r\n\t\t\tif (Object.keys(selected_places).length > 1 && live_road){\r\n\t\t\t\tfindRoads();\r\n\t\t\t} else {\r\n\t\t\t\tclearRoads();\r\n\t\t\t}\r\n\t\t\tvar event = new Event(\"roadChanged\");\r\n\t\t\tdocument.getElementById('body').dispatchEvent(event);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction addMarkerToRoad(marker, info){\r\n\tmarker.setIcon('http://maps.google.com/mapfiles/kml/pal4/icon23.png');\r\n\tselected_places[marker.getPlace().placeId] = {address: info.formatted_address, location: info.geometry.location};\r\n\tif (origin === undefined){\r\n\t\torigin = info.place_id;\r\n\t}\r\n\tif (destination === undefined || last_town_destination === true){\r\n\t\tdestination = info.place_id;\r\n\t}\r\n\tvar option = document.createElement('option');\r\n\toption.innerHTML = info.formatted_address;\r\n\toption.value = info.formatted_address;\r\n\toption.id = info.formatted_address;\r\n\tif (origin_box !== undefined){\r\n\t\torigin_box.appendChild(option);\r\n\t}\r\n\tif (destination_box !== undefined){\r\n\t\tvar option2 = option.cloneNode(true);\r\n\t\tdestination_box.appendChild(option2);\r\n\t\tif (last_town_destination){\r\n\t\t\tdestination_box.value = option.value;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction extractMarkerFromRoad(marker, info){\r\n\tmarker.setMap(null);\r\n\tdelete selected_places[marker.getPlace().placeId];\r\n\tdelete marker;\r\n\tif (origin == info.place_id){\r\n\t\tif (Obj.keys(selected_places) > 0){\r\n\t\t\tfor (place_id in selected_places){\r\n\t\t\t\torigin = place_id;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tdelete origin;\r\n\t\t}\r\n\t}\r\n\tif (destination == info.place_id){\r\n\t\tif (Obj.keys(selected_places) > 0){\r\n\t\t\tfor (place_id in selected_places){\r\n\t\t\t\tdestination = place_id;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tdelete destination;\r\n\t\t}\r\n\t}\r\n\tif (origin_box !== undefined){\r\n\t\torigin_box.removeChild(document.getElementById(info.formatted_address));\r\n\t}\r\n\tif (destination_box !== undefined){\r\n\t\tdestination_box.removeChild(document.getElementById(info.formatted_address));\r\n\t}\r\n}\r\n\r\nfunction findRoads(){\r\n\tclearOrderedMarkers();\r\n\tclearRoads();\r\n\tvar waypoints_locations = [];\r\n\tfor (place_id in selected_places){\r\n\t\tif (place_id != origin && place_id != destination){\r\n\t\t\twaypoints_locations.push({location: selected_places[place_id].location, stopover: true});\r\n\t\t\twaypoints.push(place_id);\r\n\t\t}\r\n\t}\r\n\tdirection_service.route({\r\n\t\torigin: selected_places[origin].location,\r\n\t\tdestination: selected_places[destination].location,\r\n\t\twaypoints: waypoints_locations,\r\n\t\ttravelMode: google.maps.TravelMode.DRIVING,\r\n\t\tprovideRouteAlternatives: true,\r\n\t\toptimizeWaypoints: true\r\n\t}, buildRoads);\r\n\tdirection_service.route({\r\n\t\torigin:  selected_places[origin].location,\r\n\t\tdestination:  selected_places[destination].location,\r\n\t\twaypoints: waypoints_locations,\r\n\t\ttravelMode: google.maps.TravelMode.DRIVING,\r\n\t\tprovideRouteAlternatives: true\r\n\t}, buildRoads);\r\n}\r\n\r\nfunction clearRoads(){\r\n\twaypoints.length = 0;\r\n\troads.length = 0;\r\n\troads_display.forEach(function(display_item){\r\n\t\tdisplay_item.setMap(null);\r\n\t});\r\n\troads_display.length = 0;\r\n}\r\n\r\nfunction swap(a, b){\r\n\tvar c = a;\r\n\ta = b;\r\n\tb = c;\r\n}\r\n  \r\nfunction buildRoads(result, status){\r\n\tif (status === google.maps.DirectionsStatus.OK){\r\n\t\tvar roads_length = roads.length;\r\n\t\tresult.routes.forEach(function(route_item, i){\r\n\t\t\tvar total_distance = 0;\t\t\t\r\n\t\t\tvar path\t = []; // Array of latLng\r\n\t\t\tvar stops\t = []; // Each leg contains start (address and position), end (address and position) and distance\r\n\t\t\tstops.push({place_id: origin, formatted_address: selected_places[origin].address, position: selected_places[origin].location});\r\n\t\t\troute_item.legs.forEach(function(leg_item, j){\r\n\t\t\t\tif (j != route_item.legs.length - 1){\r\n\t\t\t\t\tstops.push({place_id: waypoints[route_item.waypoint_order[j]], formatted_address: selected_places[waypoints[route_item.waypoint_order[j]]].address, position: selected_places[waypoints[route_item.waypoint_order[j]]].location});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstops.push({place_id: destination, formatted_address: selected_places[destination].address, position: selected_places[destination].location});\r\n\t\t\t\t}\r\n\t\t\t\ttotal_distance += leg_item.distance.value;\r\n\t\t\t\tleg_item.steps.forEach(function(step_item){\r\n\t\t\t\t\tstep_item.path.forEach(function(path_item){\r\n\t\t\t\t\t\tpath.push(path_item);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\troads.push({total_distance: total_distance, stops: stops, polyline: google.maps.geometry.encoding.encodePath(path)});\r\n\t\t\tdisplayRoad(roads[roads.length - 1]);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction displayRoad(road){\r\n\tvar road_display = new google.maps.Polyline({\r\n\t\tmap: map,\r\n\t\tstrokeWeight: 4,\r\n\t\tstrokeOpacity: 0.7,\r\n\t\tstrokeColor: colors[roads.length],\r\n\t\tpath: google.maps.geometry.encoding.decodePath(road.polyline)\r\n\t});\t\r\n\troad_display.addListener('click', function(){\r\n\t\troads.forEach(function(road_item, i){\r\n\t\t\tif(road_item.polyline == road.polyline){\r\n\t\t\t\tselected_road = i;\r\n\t\t\t}\r\n\t\t})\r\n\t\tselectRoad(road, road_display);\r\n\t});\t\t\t\r\n\troads_display.push(road_display);\r\n}\r\n\r\nfunction clearOrderedMarkers(){\r\n\tordered_markers.forEach(function(item){\r\n\t\titem.setMap(null);\r\n\t});\r\n\tordered_markers.length = 0;\r\n}\r\n\r\nfunction selectRoad(road, road_display){\r\n\tclearOrderedMarkers();\r\n\troads_display.forEach(function(road_display_item){\r\n\t\troad_display_item.setOptions({\r\n\t\t\tstrokeWeight: 4\r\n\t\t});\r\n\t});\r\n\troad_display.setOptions({\r\n\t\tstrokeWeight: 8\r\n\t});\r\n\tif (textarea !== undefined){\r\n\t\ttextarea.value = 'Total distance: ' + (road['total_distance'] / 1000) + 'km' + '\\n';\r\n\t}\r\n\troad['stops'].forEach(function(city_item, i){\r\n\t\tsetOrderedMarkers(city_item, i);\r\n\t\tif (textarea !== undefined){\r\n\t\t\tsetTextareaInfo(city_item, textarea);\r\n\t\t}\r\n\t});\t\r\n}\r\n\r\nfunction setOrderedMarkers(city_item, i){\r\n\tvar marker = new google.maps.Marker({\r\n\t\tmap: map,\r\n\t\tposition: city_item['position'],\r\n\t\tlabel: '' + (i + 1),\r\n\t\tzIndex: 2\r\n\t});\r\n\tordered_markers.push(marker);\r\n}\r\n\r\nfunction setTextareaInfo(city_item, textarea){\r\n\ttextarea.value += (city_item['formatted_address'] + '\\n');\r\n}\r\n\r\nfunction setLiveRoad(){\r\n\tif (live_road == false){\r\n\t\tlive_road = true;\r\n\t} else {\r\n\t\tlive_road = false;\r\n\t}\r\n}\r\n\r\nfunction setLastTownDestination(){\r\n\tif (last_town_destination == false){\r\n\t\tlast_town_destination = true;\r\n\t} else {\r\n\t\tlast_town_destination = false;\r\n\t}\r\n}\r\n\r\nfunction setNearestTownAdded(){\r\n\tif (nearest_town_added == false){\r\n\t\tnearest_town_added = true;\r\n\t} else {\r\n\t\tnearest_town_added = false;\r\n\t}\r\n}\r\n\r\nfunction clearSelectTag(elem){\r\n\tvar elem_childs = elem.getElementsByTagName('*');\r\n\tvar elem_childs_length = elem_childs.length;\r\n\tfor (var i = elem_childs_length; i > 0; i--){\r\n\t\telem_childs[i - 1].remove();\r\n\t}\r\n}\r\n\r\nfunction clearAllMarkers(){\r\n\tfor (place_id in markers){\r\n\t\tmarkers[place_id].setMap(null);\r\n\t\tdelete markers[place_id];\r\n\t\tif (selected_places[place_id] !== undefined){\r\n\t\t\tdelete selected_places[place_id];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction clearMap(){\r\n\tclearRoads();\r\n\tclearAllMarkers();\r\n\tclearOrderedMarkers();\r\n\tselected_places = {};\r\n\torigin = undefined;\r\n\tdestination = undefined;\r\n\tif (origin_box !== undefined){\r\n\t\tclearSelectTag(origin_box);\r\n\t}\r\n\tif (destination_box !== undefined){\r\n\t\tclearSelectTag(destination_box);\r\n\t}\r\n}\r\n\r\nfunction sendRoad(){\r\n\tif (selected_road === undefined){\r\n\t\talert(\"Wrong road selected!!!\");\r\n\t\treturn;\r\n\t}\r\n\tvar str = JSON.stringify(roads[selected_road]);\r\n\t//alert(str);\r\n}\r\n\r\nfunction getRoad(){\r\n\treturn roads[selected_road];\r\n}\r\n\r\nfunction setRoad(new_road){\r\n\troads.push(new_road);\r\n\tselected_road = roads.length - 1;\r\n\tdisplayRoad(new_road);\r\n\tnew_road['stops'].forEach(function(city_item, i){\r\n\t\tsetOrderedMarkers(city_item, i);\r\n\t});\r\n}\r\n\r\nfunction deleteMap(){\r\n\tclearMap();\r\n\tdelete map;\r\n}"}},[3]);